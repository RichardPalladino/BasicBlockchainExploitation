from brownie import accounts

from scripts.deploy import deploy_vuln_blockhash


def main() -> None:
    try:
        vuln_blockhash = deploy_vuln_blockhash()
        vuln_blockhash.getBlockNum()
        print(f"Current block is {vuln_blockhash.blockNum()}")
        vuln_blockhash.getBlockHash()
        print(f"Blockhash is {vuln_blockhash.hashVal()}\n")
        print("Initiating loop...")

        counter = 0
        while (
            counter < 257
        ):  # I want to check values before and after to see what the difference is
            counter += 1
            if counter > 252:
                vuln_blockhash.getBlockHash()
                print(f"Count: {counter}")
                print(f"Block: {vuln_blockhash.blockNum()}")
                print(f"Blockhash: {vuln_blockhash.hashVal()}\n")
            else:
                tx = vuln_blockhash.wasteTime()
                tx.wait(1)

    except Exception as err:
        print(f"This failed with the following error:\n{err}")


if __name__ == "__main__":
    main()
